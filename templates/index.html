<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>H·ªá th·ªëng x·∫øp l·ªãch b·ªánh nh√¢n c·∫•p c·ª©u</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  </head>
  <body>
    <div class="page">
      <div class="dashboard">
        <aside class="sidebar">
          <div class="sidebar-header">
            <h2>Heap Dashboard</h2>
            <p>Emergency Priority Queue</p>
          </div>
          <nav class="tab-nav">
            <button class="tab-button active" data-tab="tab-overview">üìå T·ªïng quan</button>
            <button class="tab-button" data-tab="tab-add">‚ûï Th√™m b·ªánh nh√¢n</button>
            <button class="tab-button" data-tab="tab-queue">üìã Danh s√°ch ∆∞u ti√™n</button>
            <button class="tab-button" data-tab="tab-stats">üìä Th·ªëng k√™</button>
            <button class="tab-button" data-tab="tab-heap">üß† Minh ho·∫° Heap</button>
            <button class="tab-button" data-tab="tab-heap-array">üß± D·∫°ng m·∫£ng</button>
            <button class="tab-button" data-tab="tab-heap-tree">üå≤ D·∫°ng c√¢y</button>
            <button class="tab-button" data-tab="tab-heap-steps">‚öôÔ∏è C√°c b∆∞·ªõc</button>
            <button class="tab-button" data-tab="tab-log">üì£ Log s·ª± ki·ªán</button>
            <button class="tab-button" data-tab="tab-theory">üìñ L√Ω thuy·∫øt</button>
          </nav>
        </aside>

        <div class="tab-content">
          <section id="tab-overview" class="tab-section">
            <header class="hero">
              <div class="hero-text">
                <p class="eyebrow">Gi·∫£i thu·∫≠t - Priority Queue b·∫±ng Max-Heap</p>
                <h1>H·ªá th·ªëng x·∫øp l·ªãch b·ªánh nh√¢n c·∫•p c·ª©u</h1>
                <p>
                  Dashboard gi√∫p m√¥ ph·ªèng c√°ch Heap ∆∞u ti√™n b·ªánh nh√¢n d·ª±a tr√™n m·ª©c ƒë·ªô nguy k·ªãch
                  v√† th·ªùi ƒëi·ªÉm nh·∫≠p vi·ªán. M·ªói tab t∆∞∆°ng ·ª©ng v·ªõi m·ªôt ph·∫ßn c·ªßa b√†i thuy·∫øt tr√¨nh ƒë·ªÉ b·∫°n
                  d·ªÖ ƒëi·ªÅu h∆∞·ªõng khi demo.
                </p>
              </div>
              <div class="hero-actions">
                <label class="seed-control">
                  <span>S·ªë l∆∞·ª£ng demo</span>
                  <select id="demoCount">
                    <option value="5" selected>5 b·ªánh nh√¢n</option>
                    <option value="10">10 b·ªánh nh√¢n</option>
                  </select>
                </label>
                <button id="demoBtn">Sinh b·ªánh nh√¢n demo</button>
                <button id="resetBtn" class="outline">Reset h·ªá th·ªëng</button>
              </div>
            </header>
            <div class="summary-grid" id="overviewSummary"></div>
          </section>

          <section id="tab-add" class="tab-section hidden">
            <article class="card">
              <div class="card-header">
                <h2>Th√™m b·ªánh nh√¢n</h2>
                <p>Form ki·ªÉm tra ƒë·∫ßy ƒë·ªß gi√° tr·ªã v√† gi·∫£i th√≠ch mapping m·ª©c ƒë·ªô nguy k·ªãch.</p>
              </div>
              <form id="patientForm" class="form-grid">
                <label>
                  M√£ b·ªánh nh√¢n
                  <input name="code" maxlength="10" required placeholder="VD: BN01" />
                </label>
                <label>
                  H·ªç t√™n
                  <input name="name" required placeholder="VD: Nguy·ªÖn VƒÉn A" />
                </label>
                <label>
                  Th·ªùi ƒëi·ªÉm nh·∫≠p vi·ªán
                  <input type="datetime-local" name="admittedAt" required />
                </label>
                <label>
                  M·ª©c ƒë·ªô nguy k·ªãch (1-10)
                  <input type="number" name="severity" min="1" max="10" required />
                </label>
                <button type="submit" class="primary">Th√™m v√†o h√†ng ƒë·ª£i</button>
              </form>

              <div class="legend" id="severityLegend"></div>
            </article>
          </section>

          <section id="tab-queue" class="tab-section hidden">
            <article class="card queue-card">
              <div class="card-header">
                <div>
                  <h2>Danh s√°ch ∆∞u ti√™n</h2>
                  <p>Sort theo m·ª©c ƒë·ªô + th·ªùi ƒëi·ªÉm nh·∫≠p vi·ªán.</p>
                </div>
                <div class="queue-actions">
                  <input type="search" id="filterInput" placeholder="L·ªçc theo t√™n ho·∫∑c m√£..." />
                  <select id="severityFilter">
                    <option value="all">T·∫•t c·∫£ m·ª©c ƒë·ªô</option>
                    <option value="Nguy k·ªãch">Nguy k·ªãch</option>
                    <option value="Nguy hi·ªÉm cao">Nguy hi·ªÉm cao</option>
                    <option value="Trung b√¨nh">Trung b√¨nh</option>
                    <option value="Nh·∫π">Nh·∫π</option>
                    <option value="R·∫•t nh·∫π">R·∫•t nh·∫π</option>
                  </select>
                  <button id="processBtn" class="primary">X·ª≠ l√Ω kh·∫©n c·∫•p nh·∫•t</button>
                </div>
              </div>
              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>M√£</th>
                      <th>T√™n</th>
                      <th>Nh·∫≠p vi·ªán</th>
                      <th>Level</th>
                      <th>Nh√≥m</th>
                      <th>H√†nh ƒë·ªông</th>
                    </tr>
                  </thead>
                  <tbody id="queueTableBody"></tbody>
                </table>
              </div>
            </article>
          </section>

          <section id="tab-stats" class="tab-section hidden">
            <article class="card stats-card">
              <div class="card-header">
                <h2>Th·ªëng k√™</h2>
                <p>Theo d√µi s·ªë l∆∞·ª£ng b·ªánh nh√¢n theo t·ª´ng m·ª©c.</p>
              </div>
              <div class="stats" id="statsPanel"></div>
            </article>

            <article class="card chart-wrapper">
              <div class="card-header">
                <h2>Bi·ªÉu ƒë·ªì th·ªëng k√™ b·ªánh nh√¢n</h2>
                <p>Ph√¢n b·ªë m·ª©c ƒë·ªô nguy k·ªãch theo d·ªØ li·ªáu hi·ªán t·∫°i trong Heap.</p>
              </div>
              <div class="charts-grid">
                <div class="chart-card">
                  <h3>Bi·ªÉu ƒë·ªì c·ªôt</h3>
                  <canvas id="statsBarChart" width="400" height="280"></canvas>
                </div>
                <div class="chart-card">
                  <h3>Bi·ªÉu ƒë·ªì donut</h3>
                  <canvas id="statsDonutChart" width="400" height="280"></canvas>
                </div>
              </div>
            </article>
          </section>

          <section id="tab-heap" class="tab-section hidden">
            <article class="card">
              <div class="card-header">
                <h2>Minh ho·∫° Heap</h2>
                <p>Gi·∫£i th√≠ch nhanh c√°ch s·ª≠ d·ª•ng hai tab minh ho·∫° b√™n d∆∞·ªõi.</p>
              </div>
              <div class="theory-content">
                <p>
                  M·ªói thao t√°c insert / extract s·∫Ω c·∫≠p nh·∫≠t c·∫£ m·∫£ng Heap (0-based) v√† c√¢y nh·ªã ph√¢n ho√†n ch·ªânh.
                  D√πng tab "D·∫°ng m·∫£ng" ƒë·ªÉ l√Ω gi·∫£i c√°ch Heap l∆∞u trong b·ªô nh·ªõ, v√† tab "D·∫°ng c√¢y" ƒë·ªÉ tr√¨nh b√†y tr·ª±c quan cha - con.
                </p>
                <p>
                  Tab "C√°c b∆∞·ªõc" cho th·∫•y log sift-up ho·∫∑c sift-down t∆∞∆°ng ·ª©ng. B·∫°n c√≥ th·ªÉ chuy·ªÉn gi·ªØa c√°c tab n√†y trong khi thao t√°c ƒë·ªÉ nh·∫•n m·∫°nh t·ª´ng kh√≠a c·∫°nh.
                </p>
              </div>
            </article>
          </section>

          <section id="tab-heap-array" class="tab-section hidden">
            <article class="card">
              <div class="card-header">
                <h2>Minh ho·∫° d·∫°ng m·∫£ng</h2>
                <p>Hi·ªÉn th·ªã c·∫•u tr√∫c Heap theo d·∫°ng array (0-based index).</p>
              </div>
              <div id="arrayView" class="array-view"></div>
            </article>
          </section>

          <section id="tab-heap-tree" class="tab-section hidden">
            <article class="card">
              <div class="card-header">
                <h2>Minh ho·∫° d·∫°ng c√¢y</h2>
                <p>Ph√¢n t·∫ßng cha - con; step highlight th·ªÉ hi·ªán node ƒëang x√©t.</p>
              </div>
              <div id="treeView" class="tree-view"></div>
            </article>
          </section>

          <section id="tab-heap-steps" class="tab-section hidden">
            <article class="card steps-card">
              <div class="card-header">
                <h2>C√°c b∆∞·ªõc thu·∫≠t to√°n</h2>
                <p>Gi·∫£i th√≠ch sift-up / sift-down c·ªßa thao t√°c g·∫ßn nh·∫•t.</p>
              </div>
              <ol id="stepsList" class="steps-list"></ol>
            </article>
          </section>

          <section id="tab-log" class="tab-section hidden">
            <article class="card log-card">
              <div class="card-header">
                <div>
                  <h2>Th√¥ng b√°o / Log</h2>
                  <p>Ghi l·∫°i thao t√°c ∆∞u ti√™n g·∫ßn nh·∫•t.</p>
                </div>
                <button id="clearLogBtn" class="outline">Xo√° log</button>
              </div>
              <ul id="logPanel" class="log-panel"></ul>
            </article>
          </section>

          <section id="tab-theory" class="tab-section hidden">
            <article class="card theory-card">
              <div class="card-header">
                <h2>Gi·ªõi thi·ªáu thu·∫≠t to√°n Heap</h2>
              </div>
              <div class="theory-content">
                <p>
                  Heap (ƒë·∫∑c bi·ªát l√† Max-Heap) l√† c·∫•u tr√∫c c√¢y nh·ªã ph√¢n ho√†n ch·ªânh trong ƒë√≥ m·ªói node lu√¥n l·ªõn h∆°n ho·∫∑c b·∫±ng c√°c node con.
                  Nh·ªù t√≠nh ch·∫•t n√†y, thao t√°c l·∫•y ph·∫ßn t·ª≠ c√≥ priority cao nh·∫•t ch·ªâ c·∫ßn O(1), c√≤n th√™m / lo·∫°i b·ªè m·∫•t O(log n) nh·ªù sift-up ho·∫∑c sift-down.
                </p>
                <p>
                  Trong b·ªëi c·∫£nh c·∫•p c·ª©u, b·ªánh nh√¢n c√≥ m·ª©c ƒë·ªô nguy k·ªãch cao (Level g·∫ßn 10) ph·∫£i ƒë∆∞·ª£c ph·ª•c v·ª• tr∆∞·ªõc.
                  N·∫øu m·ª©c ƒë·ªô b·∫±ng nhau, ng∆∞·ªùi ƒë·∫øn s·ªõm h∆°n ƒë∆∞·ª£c ∆∞u ti√™n h∆°n. V√¨ v·∫≠y Heap ph√π h·ª£p ƒë·ªÉ m√¥ ph·ªèng ph√≤ng c·∫•p c·ª©u.
                </p>
                <ul>
                  <li>Insert: th√™m node ·ªü cu·ªëi m·∫£ng r·ªìi sift-up.</li>
                  <li>Extract-max: l·∫•y node g·ªëc, ƒë∆∞a node cu·ªëi l√™n g·ªëc v√† sift-down.</li>
                  <li>Priority queue: b·∫£ng b√™n ph·∫£i lu√¥n hi·ªÉn th·ªã th·ª© t·ª± x·ª≠ l√Ω ch√≠nh x√°c.</li>
                </ul>
              </div>
            </article>
          </section>
        </div>
      </div>
    </div>

    <div class="modal" id="patientModal">
      <div class="modal-content">
        <button class="close" data-close>&times;</button>
        <h3>Th√¥ng tin b·ªánh nh√¢n</h3>
        <dl id="modalDetails"></dl>
      </div>
    </div>

    <div id="toast" class="toast" role="status"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='js/charts.js') }}"></script>
    <script src="{{ url_for('static', filename='app.js') }}"></script>
  </body>
</html>

